#!/bin/bash

#############################  IndelRealignTargetCreator
java -Xmx20G -jar /NAS7/home/shijunpeng/software/GATK/GenomeAnalysisTK.jar -T RealignerTargetCreator -R /NAS2/shijp/data/B73_V4/Zea_mays.AGPv4.dna.toplevel.fa -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu99.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu45.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu63.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu44.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu64.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu78.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu4.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu69.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu40.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu3.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu23.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu53.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu25.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu90.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu81.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu39.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu55.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu95.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu12.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu89.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu56.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu47.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu50.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu54.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu21.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu38.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu16.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu61.R1.fastq.gz.q20.sorted.MD.bam -o ./x002.AGPv4.group1.intervals -minReads 2

################################  IndelRealign
java -Xmx20G -jar /NAS7/home/shijunpeng/software/GATK/GenomeAnalysisTK.jar -T IndelRealigner -R /NAS2/shijp/data/B73_V4/Zea_mays.AGPv4.dna.toplevel.fa -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu99.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu45.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu63.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu44.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu64.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu78.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu4.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu69.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu40.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu3.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu23.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu53.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu25.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu90.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu81.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu39.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu55.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu95.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu12.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu89.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu56.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu47.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu50.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu54.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu21.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu38.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu16.R1.fastq.gz.q20.sorted.MD.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/Lu61.R1.fastq.gz.q20.sorted.MD.bam -targetIntervals ./x002.AGPv4.group1.intervals -o ./x002.AGPv4.group1.intervals.bam

#################################  BaseRecalibration
java -Xmx20G -jar /NAS7/home/shijunpeng/software/GATK/GenomeAnalysisTK.jar -T BaseRecalibrator -R /NAS2/shijp/data/B73_V4/Zea_mays.AGPv4.dna.toplevel.fa -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group10.intervals.bam -knownSites /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group10.intervals.bam.VQ20.bed -o /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group10.intervals.baseRec -bqsrBAQGOP 30

##################################  Print Reads
java -Xmx20G -jar /NAS7/home/shijunpeng/software/GATK/GenomeAnalysisTK.jar -T PrintReads -R /NAS2/shijp/data/B73_V4/Zea_mays.AGPv4.dna.toplevel.fa -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group10.intervals.bam -BQSR /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group10.intervals.baseRec -o /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group10.intervals.baseRec.bam

#################################  UnifiedGenotyper
java -Xmx20G -jar /NAS7/home/shijunpeng/software/GATK/GenomeAnalysisTK.jar -T UnifiedGenotyper -R /NAS2/shijp/data/B73_V4/Zea_mays.AGPv4.dna.toplevel.fa -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group1.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group2.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group3.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group4.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group5.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group6.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group7.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group8.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group9.intervals.baseRec.bam -I /NAS6/shijunpeng/data/hapmap2/GATK/x002.AGPv4.group10.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/GATK/x002.AGPv4.group1.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/GATK/x002.AGPv4.group2.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_data_lu/cat_reads/GATK/x002.AGPv4.group3.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group1.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group2.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group3.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group4.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group5.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group6.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group7.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group8.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group9.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group10.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group11.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group12.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group13.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group14.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group15.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group16.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group17.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group18.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group19.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group20.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/GATK/x002.AGPv4.group21.intervals.baseRec.bam -I /NAS6/shijunpeng/data/resequencing_GWAS/CAU03/x002.AGPv4.group1.intervals.baseRec.bam -A AlleleBalance -stand_call_conf 4.0 -stand_emit_conf 4.0 -mbq 20 -out_mode EMIT_ALL_CONFIDENT_SITES -L 10:1-40000000 | perl /NAS7/home/shijunpeng/data/perl_scripts/reduce.pl - ./run_UnifiedGenotyper_10_1_40000000.log | gzip - >./chr10.1_40000000.all_accessions.vcf.gz
